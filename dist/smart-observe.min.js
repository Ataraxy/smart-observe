!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("observe",t):e.observe=t()}(this,function(){"use strict";function e(e,t,n,i){Object.defineProperty(e,t,{value:n,enumerable:!!i,writable:!0,configurable:!0})}function t(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}function n(e){return K.call(e)===L}function i(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":N(e))}function o(e){return"function"==typeof e}function r(e,t){for(var n=Object.keys(e),i=0,o=n.length;i<o;i++)t(n[i],e[n[i]])}function s(){}function u(e){Object.setPrototypeOf(e,W)}function a(e,t){return e>=this.length&&(this.length=Number(e)+1),this.splice(e,1,t)[0]}function c(e){if(this.length){var t=this.indexOf(e);return t>-1?this.splice(t,1):void 0}}function f(e){if(e&&"object"===("undefined"==typeof e?"undefined":N(e))){var t=void 0;return Object.prototype.hasOwnProperty.call(e,V)&&e[V]instanceof ne?t=e[V]:(J(e)||n(e))&&Object.isExtensible(e)&&(t=new ne(e)),t}}function l(e,n,i){function o(){var t=a?a.call(e):i;if(F.target&&(s.depend(),l&&l.dep.depend(),J(t)))for(var n,o=0,r=t.length;o<r;o++)n=t[o],n&&n[V]&&n[V].dep.depend();return t}function r(t){var n=a?a.call(e):i;t!==n&&(c?c.call(e,t):i=t,l=f(t),s.notify())}var s=new F,u=Object.getOwnPropertyDescriptor(e,n);if(!u||u.configurable!==!1){var a=u&&u.get,c=u&&u.set,l=f(i);t(e,n,o,r)}}function h(e){try{return new Function("scope","return "+e+";")}catch(t){Q("Invalid expression. Generated function body: "+e)}}function d(e){return e=String.prototype.trim.call(e),h("scope."+e)}function p(){oe=!1;var e=ie.slice(0);ie.length=0;for(var t=0;t<e.length;t++)e[t]()}function v(){ce=[],fe={},le=!1}function y(){b(ce),v()}function b(e){for(he=0;he<e.length;he++){var t=e[he],n=t.id;fe[n]=null,t.run()}}function g(e){var t=e.id;null==fe[t]&&(fe[t]=ce.length,ce.push(e),le||(le=!0,ae(y)))}function w(e){var t=void 0,n=void 0;if(J(e))for(t=e.length;t--;)w(e[t]);else if(i(e))for(n=Object.keys(e),t=n.length;t--;)w(e[n[t]])}function k(e,t,n,i){var r=o(t)?t:d(t);return new pe(e,r,n,i)}function m(e,t){var n=new pe(e,t,null,{deep:O.deep,lazy:!0,sync:O.sync});return function(){return n.options.lazy&&F.target&&!F.target.options.lazy&&(n.options.lazy=!1,n.callback=function(){for(var e=n.deps,t=0,i=e.length;t<i;t++)e[t].notify()}),n.dirty&&n.evaluate(),F.target&&n.depend(),n.value}}function O(e,t,n,i){return I(e),O.default(e,t,n,i)}function j(e,t){return t?I(t):(t={},_(t)),e.methods&&x(t,e.methods),e.data&&P(t,e.data),e.computed&&G(t,e.computed),e.watchers&&T(t,e.watchers),t}function D(e,n,i,r){I(e);var u=void 0,a=void 0;o(i)?(u=r!==!1?m(e,i):i.bind(this),a=s):(u=i.get?i.cache!==!1||r!==!1?m(e,i.get):i.get.bind(this):s,a=i.set?i.set.bind(this):s),t(e,n,u,a)}function S(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O;return I(e),k(e,t,n,i)}function _(t){e(t,q,[],!1),e(t,B,Object.create(null),!1),f(t[B]),A(t)}function I(e){Object.prototype.hasOwnProperty.call(e,q)||_(e)}function x(e,t){r(t,function(t,n){e[t]=n.bind(e)})}function z(e,t,n){e[B][t]=n,l(e[B],t,n),E(e,t)}function P(e,t){r(t,function(t,n){return z(e,t,n)})}function A(e){r(e,function(t,n){!o(n)&&z(e,t,n)})}function G(e,t){r(t,function(t,n){return D(e,t,n)})}function T(e,t){r(t,function(t,n){o(n)?S(e,t,n):S(e,t,n.watcher,n)})}function E(e,n){function i(){return e[B][n]}function o(t){e[B][n]=t}t(e,n,i,o)}var N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},M=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),C=0,F=function(){function e(){$(this,e),this.id=C++,this.subs=[]}return M(e,[{key:"addSub",value:function(e){this.subs.push(e)}},{key:"removeSub",value:function(e){this.subs.$remove(e)}},{key:"depend",value:function(){e.target.addDep(this)}},{key:"notify",value:function(){for(var e=this.subs,t=0,n=e.length;t<n;t++)e[t].update()}}]),e}();F.target=null;var V="__s_o__",q="__watchers__",B="__data__",H="undefined"!=typeof process&&"production"!==process.env.NODE_ENV,J=Array.isArray,K=Object.prototype.toString,L="[object Object]",Q="undefined"!=typeof H&&H&&"undefined"!=typeof console&&console&&o(console.warn)?console.warn:s,R=void 0;"undefined"!=typeof Set&&Set.toString().match(/native code/)?R=Set:(R=function(){this.set=Object.create(null)},R.prototype.has=function(e){return void 0!==this.set[e]},R.prototype.add=function(e){this.set[e]=1},R.prototype.clear=function(){this.set=Object.create(null)});for(var U=Array.prototype,W=Object.create(U),X=["push","pop","shift","unshift","splice","sort","reverse"],Y=function(t,n){var i=X[t],o=U[i];e(W,i,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=o.apply(this,t),s=this[V],u=void 0;switch(i){case"push":u=t;break;case"unshift":u=t;break;case"splice":u=t.slice(2)}return u&&s.observeArray(u),s.dep.notify(),r})},Z=0,ee=X.length;Z<ee;Z++)Y(Z,ee);e(U,"$set",a),e(U,"$remove",c);var te,ne=function(){function t(n){$(this,t),this.value=n,this.dep=new F,e(n,V,this),J(n)?(u(n),this.observeArray(n)):this.walk(n)}return M(t,[{key:"walk",value:function(e){var t=this;r(e,function(e,n){return t.convert(e,n)})}},{key:"observeArray",value:function(e){for(var t=0,n=e.length;t<n;t++)f(e[t])}},{key:"convert",value:function(e,t){l(this.value,e,t)}}]),t}(),ie=[],oe=!1;if("object"===("undefined"==typeof process?"undefined":N(process))&&process&&"function"==typeof process.nextTick)te=process.nextTick;else if("undefined"!=typeof MutationObserver){var re=0,se=document.createTextNode(re),ue=new MutationObserver(p);ue.observe(se,{characterData:!0}),te=function(){re=0===re?1:0,se.data=String(re)}}else te=setTimeout;var ae=function(e,t){var n=e;if(t){for(var i=[],o=arguments.length;--o>1;)i.unshift(arguments[o]);n=function(){e.apply(t,i)}}ie.push(n),oe||(oe=!0,te(p))},ce=[],fe={},le=!1,he=void 0,de=0,pe=function(){function e(t,n,i,o){$(this,e),t[q].push(this),this.owner=t,this.getter=n,this.callback=i,this.options=o,this.id=++de,this.active=!0,this.dirty=o.lazy,this.deps=[],this.newDeps=[],this.depIds=new R,this.newDepIds=new R,this.value=o.lazy?void 0:this.get()}return M(e,[{key:"get",value:function(){this.beforeGet();var e=this.owner,t=this.getter.call(e,e);return this.options.deep&&w(t),this.afterGet(),t}},{key:"beforeGet",value:function(){F.target=this}},{key:"addDep",value:function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))}},{key:"afterGet",value:function(){F.target=null;for(var e=this.deps.length;e--;){var t=this.deps[e];this.newDepIds.has(t.id)||t.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0}},{key:"update",value:function(){this.options.lazy?this.dirty=!0:this.options.sync?this.run():g(this)}},{key:"run",value:function(){if(this.active){var e=this.get();if(e!==this.value||i(e)||this.options.deep){var t=this.value;this.value=e,this.callback.call(this.owner,e,t)}}}},{key:"evaluate",value:function(){var e=F.target;this.value=this.get(),this.dirty=!1,F.target=e}},{key:"depend",value:function(){for(var e=this.deps.length;e--;)this.deps[e].depend()}},{key:"teardown",value:function(){if(this.active){for(var e=this.deps.length;e--;)this.deps[e].removeSub(this);this.active=!1,this.owner=this.callback=this.value=null}}}]),e}();return Object.defineProperties(O,{react:{value:j},compute:{value:D},watch:{value:S},default:{value:S,writable:!0},deep:{value:!1,writable:!0},lazy:{value:!1,writable:!0},sync:{value:!1,writable:!0}}),O});
//# sourceMappingURL=smart-observe.min.js.map
